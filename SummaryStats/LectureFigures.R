getwd()

pdf("LectureFigures/OutlierDistMeanMedian.pdf",w=7,h=4.5)
x<- c(rnorm(10000, mean = 10, sd = 2),rnorm(800, mean = 60, sd = 2))
hist(x,col="#EF6E37",border="#EA6E47",breaks=100,main="Distribution with outliers",xlab = "Value")
abline(v=mean(x),lwd=3,lty=2,col="grey40")
text(mean(x),800,"Arithmetic mean",srt=90,pos=2)
abline(v=median(x),lwd=3,lty=2,col="grey40")
text(median(x),800,"Median",srt=90,pos=2)
modeVal = as.numeric(names(sort(-table(x)))[1])
dev.off()


pdf("LectureFigures/NormalDistMeanMedian.pdf",w=7,h=4.5)
x<- c(rnorm(10000, mean = 10, sd = 2))
hist(x,col="#EF6E37",border="#EA6E47",breaks=100,main="Normal distribution",xlab="Value")
abline(v=mean(x),lwd=3,lty=2,col="grey40")
text(9.9,400,"Arithmetic mean",srt=90,pos=2)
abline(v=median(x),lwd=3,lty=2,col="grey40")
text(10.8,400,"Median",srt=90,pos=2)
dev.off()

pdf("LectureFigures/Spread.pdf",w=5,h=4)
par(mar=c(.1,.1,.1,.1))
par(oma=c(.1,.1,.1,.1))
myd <- rnorm(5000,6,.7)
dens <- density(myd,adjust=3)
plot(dens, xlim = c(0, 12), xaxt = 'n', bty = 'n',axes=F,xlab="",ylab="",main="",type="n")
polygon(c(3, dens$x, 12), c(0, dens$y, 0),col="grey40",border=NA)
myd <- rnorm(5000,6,1.5)
dens <- density(myd,adjust=3)
polygon(c(3, dens$x, 12), c(0, dens$y, 0),col=rgb(1,0,0,1/2),border=NA)
dev.off()

pdf("LectureFigures/Location.pdf",w=7,h=4)
par(mar=c(.1,.1,.1,.1))
par(oma=c(.1,.1,.1,.1))
myd <- rnorm(5000,6,.7)
dens <- density(myd,adjust=3)
plot(dens, xlim = c(1, 12), xaxt = 'n', bty = 'n',axes=F,xlab="",ylab="",main="",type="n")
polygon(c(3, dens$x, 12), c(0, dens$y, 0),col="grey40",border=NA)
dens$x <-dens$x+3
polygon(c(3, dens$x, 12), c(0, dens$y, 0),col=rgb(1,0,0,1/2),border=NA)
dev.off()


pdf("LectureFigures/Skewness.pdf",w=7,h=4)
par(mar=c(.1,.1,.1,.1))
par(oma=c(.1,.1,.1,.1))
myd <-  rlnorm(500,0,1.8)
dens1 <- density(myd,adjust=3)
myd <- rnorm(500,1,1)
dens2 <- density(myd,adjust=5)
dens2$x = dens2$x
plot(dens2, xaxt = 'n', bty = 'n',axes=F,xlab="",ylab="",main="",type="n",xlim=c(-5,25))
polygon(c(min(dens2$x), dens2$x, max(dens2$x)), c(0, dens2$y, 0),col="grey40",border=NA)
polygon(c(min(dens1$x), dens1$x, max(dens1$x)), c(0, dens1$y, 0),col=rgb(1,0,0,1/2),border=NA)
dev.off()


pdf("LectureFigures/Mode.pdf",w=7,h=5)
par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(3, 1, 0), las=0)
x = c(15 ,19, 15,  5 , 5 , 1)
barplot(x,col="#EA6E47",border=NA,xlab = "Number of kids",ylab="Frequency",names.arg=0:5)
abline(v=mean(rep(0:5,x)))
dev.off()


pdf("LectureFigures/Spreadmeasures.pdf",w=5,h=7)
par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(3, 1, 0), las=0)
x = rnorm(50,10,2)
h = barplot(rep(mean(x),3),col="#EA6E47",border=NA,xlab = "",ylab="Value",ylim=c(0,17))
arrows(h[1],(mean(x)-var(x)),h[1],(mean(x)+var(x)),angle=90,code=3,lwd=2,col="grey30")
arrows(h[2],(mean(x)-sd(x)),h[2],(mean(x)+sd(x)),angle=90,code=3,lwd=2,col="grey30")
sem = var(x)/sqrt(length(x))
arrows(h[3],(mean(x)-sem),h[3],(mean(x)+sem),angle=90,code=3,lwd=2,col="grey30")
dev.off()


pdf("LectureFigures/FiveNumSum1.pdf",w=7,h=6)
par(bty = 'n')
boxplot(spines$SpineLength,col="#EF6E37",ylab="Spine length (mm)")
minv = min(spines$SpineLength)
maxv = max(spines$SpineLength)
medv = median(spines$SpineLength)
qv = quantile(spines$SpineLength,probs = c(0.25,0.75))
arrows(rep(0.65,5), c(minv,maxv,medv,qv), x1 = c(rep(0.86,2),rep(0.78,3)), y1 = c(minv,maxv,medv,qv),length= 0.1,col="grey")
text(rep(0.65,5), c(minv,maxv,medv,qv),labels = c("Minimum","Maximum","Median","1st Quartile","3rd Quartile"),pos=2,cex=0.8,col="grey")
dev.off()

pdf("LectureFigures/FiveNumSum2.pdf",w=7,h=6)
x <- sort(spines$SpineLength)
plot(x,col="#EF6E37",bty="n",pch=16,cex=1.5,ylab="Spine length (mm)")
points(25:26,x[25:26],pch=16,cex=1.5)
points(13:14,x[13:14],pch=16,cex=1.5)
points(37:38,x[37:38],pch=16,cex=1.5)
points(1,x[1],pch=16,cex=1.5)
points(50,x[50],pch=16,cex=1.5)

lines(x = c(8.5,25.5,25.5), y = c(mean(x[25:26]),mean(x[25:26]),0),lty=2,col="grey")
lines(x = c(8.5,13.5,13.5), y = c(weighted.mean(x[13:14],w=c(0.75,.25)),weighted.mean(x[13:14],w=c(0.25,.75)),0),lty=2,col="grey")
lines(x = c(8.5,37.5,37.5), y = c(weighted.mean(x[37:38],w=c(0.25,.75)),weighted.mean(x[37:38],w=c(0.25,.75)),0),lty=2,col="grey")

text(rep(9.5,3), c(mean(x[25:26]),mean(x[13:14]),mean(x[37:38])),labels = c("Median","1st Quartile","3rd Quartile"),pos=2,cex=0.8,col="grey")
dev.off()

pdf("LectureFigures/ConfidenceInterval.pdf",w=5,h=7)
par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(3, 1, 0), las=0)
x = rnorm(50,10,2)
h = barplot(rep(mean(x),4),col="#EA6E47",border=NA,xlab = "",ylab="Value",ylim=c(0,17))
arrows(h[1],(mean(x)-var(x)),h[1],(mean(x)+var(x)),angle=90,code=3,lwd=2,col="grey30")
arrows(h[2],(mean(x)-sd(x)),h[2],(mean(x)+sd(x)),angle=90,code=3,lwd=2,col="grey30")
sem = var(x)/sqrt(length(x))
arrows(h[3],(mean(x)-sem),h[3],(mean(x)+sem),angle=90,code=3,lwd=2,col="grey30")
arrows(h[4],(mean(x)-sem*1.96),h[4],(mean(x)+sem*1.96),angle=90,code=3,lwd=2,col="grey30")
dev.off()

pdf("LectureFigures/ConfidenceInterval2.pdf",w=5,h=7)
par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(3, 1, 0), las=0)
x1 = rnorm(50,8,2)
x2 = rnorm(50,12,2)
h = barplot(c(mean(x1),mean(x2)),col="#EA6E47",border=NA,xlab = "",ylab="Value",ylim=c(0,17))
sem1 = var(x1)/sqrt(length(x1))
sem2 = var(x2)/sqrt(length(x2))
arrows(h[1],(mean(x1)-sem1*1.96),h[1],(mean(x1)+sem1*1.96),angle=90,code=3,lwd=2,col="grey30")
arrows(h[2],(mean(x2)-sem2*1.96),h[2],(mean(x2)+sem2*1.96),angle=90,code=3,lwd=2,col="grey30")
dev.off()

pdf("LectureFigures/ConfidenceInterval3.pdf",w=5,h=7)
par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(3, 1, 0), las=0)
x1 = rnorm(50,10,2)
x2 = rnorm(50,12.3,2)
h = barplot(c(mean(x1),mean(x2)),col="#EA6E47",border=NA,xlab = "",ylab="Value",ylim=c(0,17))
sem1 = var(x1)/sqrt(length(x1))
sem2 = var(x2)/sqrt(length(x2))
arrows(h[1],(mean(x1)-sem1*1.96),h[1],(mean(x1)+sem1*1.96),angle=90,code=3,lwd=2,col="grey30")
arrows(h[2],(mean(x2)-sem2*1.96),h[2],(mean(x2)+sem2*1.96),angle=90,code=3,lwd=2,col="grey30")
dev.off()

coinToss <- c("H","T")

for(i in 1:10){
pdf(paste("LectureFigures/cointossSmall",i,".pdf",sep=""),w=3,h=4)
par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(1, 1, 0), las=0)
outcome = sample(coinToss,6,replace = TRUE)
table(outcome)
barplot(table(outcome),col=c("black","white"),las=1,ylim=c(0,6))
dev.off()
}

for(i in 1:10){
  pdf(paste("LectureFigures/cointossLarge",i,".pdf",sep=""),w=3,h=4)
  par(mar=c(5.1, 4.1, 4.1, 2.1), mgp=c(1, 1, 0), las=0)
  outcome = sample(coinToss,5000,replace = TRUE)
  table(outcome)
  barplot(table(outcome),col=c("black","white"),las=1,ylim=c(0,3000))
  dev.off()
}

